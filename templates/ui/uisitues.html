{% extends "base_index.html" %}
{% block content %}
{% for message in get_flashed_messages() %}
<div class="alert">{{ message }}</div>
{% endfor %}
<script language="javascript">
  function loading() {
    document.getElementById("loadDiv").style.display = "block";
  }
</script>
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>名称</th>
      <th>执行模式</th>
      <th>步骤</th>
      <th>描述</th>
      <th>创建者</th>
      <th>创建时间</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    {% for uisitue in uisitues %}
    <tr>
      <td>{{ loop.index }}</td>
      <td>{{ uisitue['name'] }}</td>
      <td>{{ uisitue['exec_mode'] }}</td>
      <td style="position: relative;">
        <span id="pack_{{ loop.index }}">
          {{ uisitue['steps'].split("\r\n")[0] }}<br />
        </span>
        <span id="more_{{ loop.index }}" style="display: none;">
          {% for case_step in uisitue['steps'].split("\r\n") %}
          {{ case_step }}<br />
          {% endfor %}
        </span>
        {% if uisitue['steps'].split("\r\n")|length > 1 %}
        <a id="expand_more_{{ loop.index }}" class="expand_more_pack" onclick="more('{{ loop.index }}')"> ↓ </a>
        <a id="expand_pack_{{ loop.index }}" class="expand_more_pack" onclick="pack('{{ loop.index }}')" style="display: none;"> ↑ </a>
        {% endif %}
      </td>
      <td>{{ uisitue['description'] }}</td>
      <td>{{ uisitue['username'] }}</td>
      <td>{{ uisitue['create_date'] }}</td>
      <td>
        {% for opera,links in operation %}
        {% if opera != '提交' %}
        <span class="opration"><a href="{{ SITEURL }}/uisitue_{{ links }}/{{ uisitue['id'] }}"
            onclick="loading()">{{ opera }}</a></span>
        {% endif %}
        {% endfor %}
      </td>
    </tr>
    {% endfor %}
    <tr>
      <td colspan="11">
        {% for page in range(all_Page) %}
        <span class="opration"><a href="{{ SITEURL }}/uisitues/{{ page+1 }}">{{ page+1 }}</a></span>
        {% endfor %}
      </td>
    </tr>
  </tbody>
</table>
<div id="loadDiv"><img src="{{ SITEURL }}/static/img/loading.gif" /></div>
<div class="new">
  <ul>
    <li>
      <a href="{{ SITEURL }}/new_uisitue">新建</a>
    </li>
  </ul>
</div>
{% endblock %}